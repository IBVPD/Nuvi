{%extends "::base.html.twig" %}
{%block pagetitle %}{{'Import Cases'|trans}}{%endblock %}

{%block body %}
    <div class="row">
        <div class="col-sm-3">
            <div class="widget-box">
                <div class="widget-header widget-header-small header-color-blue">
                    <h5>{{'New Uploads'|trans}}</h5>
                </div>
                <div class="widget-body">
                    <form method="POST" action="{{path('importIndex')}}" {{form_enctype(form)}}>
                        <div class="widget-main">
                            {{form_row(form.map)}}
                            {{form_row(form.file)}}
                        </div>
                        <div class="widget-toolbox padding-6 clearfix">
                            {{form_row(form.import)}}
                            {{form_rest(form)}}
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-sm-9">
            <div class="widget-box no-border">
                <div class="widget-header widget-header-small header-color-blue">
                    <h5>{{'Recent Uploads'|trans}}</h5>
                    <div class="widget-toolbar no-border">{{ knp_pagination_render(results) }}</div>
                </div>
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>{{'Date/Time'|trans}}</th>
                                <th>{{'Map'|trans}}</th>
                                <th>{{'File'|trans}}</th>
                                <th>{{'File Record Count'|trans}}</th>
                                <th>{{'Records Read'|trans}}</th>
                                <th>{{'Total Processed'|trans}}</th>
                                <th>{{'Success Count'|trans}}</th>
                                <th>{{'Duplicate Count'|trans}}</th>
                                <th>{{'Error Count'|trans}}</th>
                                <th>{{'Warning Count'|trans}}</th>
                                <th>{{'Actions'|trans}}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {%for r in results %}
                                <tr>
                                    <td>{{r.importedAt.format('Y-m-d H:i:s')}}</td>
                                    <td>{{r.mapName}}</td>
                                    <td>{{r.filename}}</td>
                                    <td>{{r.totalRowCount}}</td>
                                    <td>{{r.total}}</td>
                                    <td>{{r.totalCount}}</td>
                                    <td>{{r.successCount}}</td>
                                    <td>{{r.duplicateCount}}</td>
                                    <td>{{r.errorCount}}</td>
                                    <td>{{r.warningCount}}</td>
                                    <td>
                                        <a href="{{path('importResultDownload',{type:'errors','id':r.id})}}" class="btn btn-xs btn-danger">{{'Errors'|trans}} <i class="icon icon-cloud-download"></i></a>
                                        <a href="{{path('importResultDownload',{type:'duplicates','id':r.id})}}" class="btn btn-xs btn-danger">{{'Duplicates'|trans}} <i class="icon icon-cloud-download"></i></a>
                                        <a href="{{path('importResultDownload',{type:'success','id':r.id})}}" class="btn btn-xs btn-success">{{'Successful'|trans}} <i class="icon icon-cloud-download"></i></a>
                                    </td>
                                </tr>
                            {%endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
{%endblock%}