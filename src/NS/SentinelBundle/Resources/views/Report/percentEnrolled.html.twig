{%extends "NSSentinelBundle::layout.html.twig" %}
{%block pagetitle %}{{'Number and Percent Enrolled: Admit Diagnosis'|trans}}{%endblock %}

{% block body %}
    <div class="row-fluid">
        <div class="col-sm-9">
            <div class="widget-box no-border">
                <div class="widget-header widget-header-small header-color-blue">
                <h5>{{'Results'|trans}}</h5>
            </div>
                
                <table class="table table-bordered table-striped">
                    <thead class="thin-border-bottom">
                    <tr>
                        {% for r in results.headers %}
                            <th>{{r}}</th>
                        {% endfor %}

                    </tr>
                    </thead>
                    {% for i in 1..12 %}
                        <tr>
                            <td>{{i}}</td>
                            {%for c in results.getMonthResult(i) %}
                                <td>{{c}}</td>
                            {%endfor%}
                        </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
        <div class="col-sm-3">
            <div class="widget-box">
                <div class="widget-header widget-header-small header-color-blue">
                    <h5>{{'Filters'|trans}}</h5>
                </div>
                <div class="widget-body">
                    <div class="widget-main">
                        <form method="POST" action="{{path('reportPercentEnrolled')}}" class="reportFilters">
                            {{form_rest(form)}}
                        </form>                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row-fluid">
        <div class="col-sm-12">
            <div id="chart_div" style="width: 1024px; height: 500px;"></div>
        </div>
    </div>
<script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([
            [ 
            {% for r in results.headers %}
                '{{r}}'{%if not loop.last%},{%endif%}
            {% endfor %}
                ],
            {% for i in 1..12 %}['{{i}}', {%for c in results.getMonthResult(i) %}{{c}}{%if not loop.last%},{%endif%}{%endfor%}]{%if not loop.last%},{%endif%}{% endfor %}

            ]);

        var options = {
          title: 'Number Enrolled By Month & Suspected Diagnosis',
          vAxis: { title: 'Occurances'},
          hAxis: { title: 'Month'},
          bar: {groupWidth: '90%'},
          annotations: { boxStyle: { stroke: '#888', strokeWidth: 1,} }
        };

        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
</script>
{% endblock %}

